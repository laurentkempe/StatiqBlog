ArchiveSources: => $"posts/**/*"
ArchiveDestination: => $"../output/all-archives/index.html"
---
@using System.Globalization
@inherits StatiqRazorPage<IDocument>

<div id="archives" class="main-content-wrap">
    <form id="filter-form" action="#">
        <input name="date" type="text" class="form-control input--xlarge" placeholder="@this.GetLocalized("global.search_date")" autofocus="autofocus">
    </form>
    <h5 class="archive-result text-color-base text-xlarge"
        data-message-zero="@this.GetLocalized("global.posts_found.zero")"
        data-message-one="@this.GetLocalized("global.posts_found.one")"
        data-message-other="@this.GetLocalized("global.posts_found.other")"></h5>
    <section class="boxes">
        @foreach (var postPerYear in Document.GetChildren().AsBlogPosts().GroupBy(post => post.DateTime.Year))
        {
            var year = postPerYear.First().DateTime.Year;
            <div class="archive archive-year box" data-date="@year">
                <h4 class="archive-title">
                    <a class="link-unstyled" href="/archives/@year">@year</a>
                </h4>
                @foreach (var postPerYearPerMonth in postPerYear.GroupBy(post => post.DateTime.Month).OrderByDescending(posts => posts.Key))
                {
                    var month = postPerYearPerMonth.First().DateTime.Month.ToString("D2");
                    <ul class="archive-posts archive-month" data-date="@year@month">
                        <h5 class="archive-title">
                            <a class="link-unstyled" href="/archives/@year/@month">@this.GetLocalizedMonth(postPerYearPerMonth.First().DateTime.Month)</a>
                        </h5>
                        @foreach (var post in postPerYearPerMonth.OrderByDescending(post => post.DateTime))
                        {
                            <li class="archive-post archive-day" data-date="@post.DateTime.ToString("yyyyMMdd")">
                                <a class="archive-post-title" href="@post.Permalink">@post.Title</a>
                                <span class="archive-post-date"> - @post.Date</span>
                            </li>
                        }
                    </ul>
                }
            </div>
        }
    </section>
</div>